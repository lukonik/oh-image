---
import StarlightPage from "@astrojs/starlight/components/StarlightPage.astro";
import { Aside } from "@astrojs/starlight/components";
import { Code } from "@astrojs/starlight/components";
import { loaders } from "../../../data/loaders/loaders";

export function getStaticPaths() {
  return loaders.map((loader) => ({
    params: { slug: loader.slug },
    props: { loader },
  }));
}

const { loader } = Astro.props;

const loaderName = loader.name;
const providerName = `${loaderName}LoaderProvider`;
const useLoaderName = `use${loaderName}Loader`;
const useContextName = `use${loaderName}Context`;
---

<StarlightPage frontmatter={{ title: loader.title }}>
  <p>
    This integration allows you to use <strong>{loader.name}</strong> for image optimization.
    For more details, refer to the <a href={loader.link}
      >official documentation</a
    >.
  </p>
  <h2>Module import</h2>
  <Code
    lang={"ts"}
    code={`import * as ${loader.name} from '@lonik/oh-image/${loader.name.toLowerCase()}'`}
  />
  <h2>URL Schema</h2>
  <p>The loader generates URLs following this pattern:</p>
  <Code code={loader.urlSchema} lang="bash" title="URL Schema" />
  <h2>{useLoaderName}</h2>
  <p>
    The primary hook for generating the loader function. It accepts
    configuration options (including transforms and placeholder settings) and
    returns a function that generates the final image URL. Pass this result to
    the <code>loader</code> prop of the <code>Image</code> component.
  </p>
  <Code
    code={`import { ${useLoaderName} } from '@lonik/oh-image/${loader.name.toLowerCase()}';
import { Image } from '@lonik/oh-image/react'

function MyComponent() {
  const loader = ${useLoaderName}(${loader.defaults});

  return (
    <Image
      src="image.jpg"
      width={500}
      loader={loader}
      placeholder={true}
    />
  );
}`}
    lang="tsx"
    title={`Using ${useLoaderName}`}
  />

  <h2>{providerName}</h2>
  <p>
    A Context Provider that configures global options for all child components
    using this loader. This is the recommended way to set the base path/URL and
    default transforms.
  </p>
  <Code
    code={`import { ${providerName} } from '@lonik/oh-image/${loader.name.toLowerCase()}';
function App() {
  return (
    <${providerName}
      path="https://example.com/images"
      transforms={OPTIONS}
      placeholder={PLACEHOLDER_OPTIONS}
    >
      <MyApp />
    </${providerName}>
  );
}`}
    lang="tsx"
    title={`Configuring ${providerName}`}
  />

  <h2>{useContextName}</h2>
  <p>returns the global configuration of the loader</p>

  <h2>Global Defaults</h2>
  By default the loader is configured with the following properties:
  <Code
    code={loader.defaults}
    lang="ts"
    title={`${loader.title} Default Config`}
  />

  <h2>Transforms Option</h2>
  <p>
    Below is the transformation
    options for this loader.
  </p>
  <Aside>
    We try to keep parameters updated, but if you notice any missing, you can
    still pass them, the URL will generate correctly despite the lack of
    TypeScript IntelliSense. If you find a missing parameter, please open a
    GitHub issue so we can add official support.
  </Aside>
  <Code code={loader.interface} lang="ts" title={`${loader.title} Interface`} />
</StarlightPage>
