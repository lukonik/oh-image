---
title: Static Image
description: Import and use optimized images directly with the oh-image Vite plugin
---

import { Tabs, TabItem } from "@astrojs/starlight/components";

The `oh-image` Vite plugin handles all the image optimization for the library. It takes your image imports, processes them using [Sharp](https://sharp.pixelplumbing.com/), and creates optimized files ready for the web.

## Overview

Unlike standard Vite image handling which returns a simple URL string, the `oh-image` plugin transforms your image imports into rich data objects. This allows for:

- **Automatic Format Conversion**: Convert images to modern formats like WebP or AVIF.
- **Responsive Images**: Automatically generate `srcSet` for different screen sizes.
- **Lazy Loading Placeholders**: Create blurred low-quality placeholders (LQIP) for smooth loading experiences.
- **On-the-fly Processing**: Resize, crop, rotate, and adjust images directly via import parameters.

## Usage

Using the plugin involves two main steps: configuration in Vite and importing images in your code.

### 1. Vite Configuration

Add the `ohImage` plugin to your `vite.config.ts`:

```ts
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";
import { ohImage } from "@lonik/oh-image/plugin";

export default defineConfig({
  plugins: [
    ohImage({
      // Global configuration (optional)
      format: "webp",
      placeholder: true,
    }),
    react(),
  ],
});
```

### 2. Importing Images

To trigger the plugin, simply append `?oh` to your image import path:

```ts
import myImage from "./assets/photo.jpg?oh";
```

You can also pass query parameters to customize the output for a specific image:

```ts
// Convert to AVIF and resize to 800px width
import hero from "./assets/hero.jpg?oh&format=avif&width=800";
```

## Using Imported Images

When you import an image with `?oh`, the plugin returns a **ready-to-use React component**. This component wraps the underlying `<Image />` primitive and automatically supplies all the optimized properties (src, srcSet, placeholder, dimensions).

You **do not** pass this import to the `Image` component. You render it directly.

```tsx
// 1. Import the component (Component name usually starts with Uppercase)
import MyImage from "./assets/photo.jpg?oh";

export function App() {
  // 2. Render it directly
  return <MyImage alt="My Photo" />;
}
```

The component accepts all standard `<Image />` props (like `className`, `style`, `onClick`, `priority`, etc.), which will be passed down to the internal image element.

```tsx
<MyImage 
  alt="Hero Background" 
  className="hero-img" 
  priority={true} 
/>
```

## Public Folder Restriction

**Important:** The plugin can only process images located within your project's source directory (e.g., `src/assets/`, `src/images/`).

Images placed in the `public/` folder are served as-is by Vite and bypass the build process, meaning `oh-image` cannot optimize them. Move any images you wish to optimize into your `src/` folder.

## Import Options

You can configure image processing on a per-file basis using query parameters. Append these to the import URL after `?oh`.

### Basic Options

| Option        | Type       | Description                                                                 |
| :------------ | :--------- | :-------------------------------------------------------------------------- |
| `width`       | `number`   | Resize image to this width (maintains aspect ratio if height is omitted).   |
| `height`      | `number`   | Resize image to this height (maintains aspect ratio if width is omitted).   |
| `format`      | `string`   | Output format (`webp`, `avif`, `png`, `jpg`). Overrides global setting.     |
| `placeholder` | `boolean`  | Generate a blurred placeholder? (`true`/`false`). Overrides global setting. |
| `breakpoints` | `number[]` | Comma-separated list of widths for `srcSet`. Overrides global setting.      |

### Transformation Options

The plugin exposes many powerful [Sharp](https://sharp.pixelplumbing.com/api-operation) operations directly:

| Option      | Type      | Description                                    |
| :---------- | :-------- | :--------------------------------------------- |
| `blur`      | `number`  | Blur the image with the specified sigma.       |
| `flip`      | `boolean` | Flip the image vertically.                     |
| `flop`      | `boolean` | Flop the image horizontally.                   |
| `rotate`    | `number`  | Rotate the image by the specified angle.       |
| `sharpen`   | `number`  | Sharpen the image with the specified sigma.    |
| `median`    | `number`  | Apply a median filter with the specified size. |
| `gamma`     | `number`  | Apply gamma correction.                        |
| `negate`    | `boolean` | Negate the image colors.                       |
| `normalize` | `boolean` | Normalize the image contrast.                  |
| `threshold` | `number`  | Apply a threshold with the specified value.    |

### Examples

```ts
// Resize to 500x500 and flip vertically
import Avatar from "./avatar.png?oh&width=500&height=500&flip=true";

// Apply a blur effect
import Background from "./bg.jpg?oh&blur=10";

// Disable placeholder for a specific icon
import Icon from "./icon.png?oh&placeholder=false";
```

### Resetting Global Defaults

You can explicitly unset a global option by passing it without a value:

```ts
// Use original format instead of global default (e.g. WebP)
import Original from "./photo.jpg?oh&format";
```

## Global Configuration

You can set default behavior for all images in your `vite.config.ts`.

```ts
ohImage({
  // Default output format
  format: "webp",

  // Enable/disable placeholders globally
  placeholder: true,

  // Default breakpoints for responsive images
  breakpoints: [640, 768, 1024, 1280, 1536],

  // Output directory for build assets
  distDir: "oh-images",
});
```

### Global Options Reference

| Option        | Type       | Default                                                   | Description                                                   |
| :------------ | :--------- | :-------------------------------------------------------- | :------------------------------------------------------------ |
| `format`      | `string`   | `"webp"`                                                  | Default output format.                                        |
| `placeholder` | `boolean`  | `true`                                                    | Generate placeholders by default.                             |
| `breakpoints` | `number[]` | `[16, 48, 96, 128, 384, 640, 750, 828, 1080, 1200, 1920]` | Default widths for `srcSet` generation.                       |
| `distDir`     | `string`   | `"oh-images"`                                             | Folder name inside `dist/assets/` where images will be saved. |

## Build vs Dev Mode

The plugin operates differently depending on your environment to balance speed and performance.

### Development (Lazy Processing)

In development, images are processed **lazily**.

1.  When you import an image, the plugin returns a URL pointing to a virtual dev server path.
2.  Processing (resizing, conversion) only happens when the browser actually requests that image.
3.  The result is cached in `node_modules/.cache` to speed up subsequent reloads.

### Production Build (Eager Processing)

During `vite build`, images are processed **eagerly**.

1.  The plugin scans your code for all `?oh` imports.
2.  It processes all images and their generated variants (breakpoints, placeholders) in parallel.
3.  Optimized files are written to the output directory (`dist/`).
4.  Import paths are rewritten to point to these optimized assets.