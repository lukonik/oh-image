---
title: Cloudflare Loader
description: Using Cloudflare Image Resizing with oh-image
---

The `useCloudflareLoader` hook provides integration for Cloudflare-based image optimization.

## Usage

### 1. Per-Component Usage

You can use the hook directly within a component to create a loader for a specific image.

```tsx
import { Image, useCloudflareLoader } from "@lonik/oh-image/react";

function MyComponent() {
  const loader = useCloudflareLoader({
    path: "https://your-worker-or-zone.com",
    format: "auto",
  });

  return (
    <Image
      src="https://example.com/photo.jpg"
      width={800}
      height={600}
      loader={loader}
      alt="Processed via Cloudflare"
    />
  );
}
```

### 2. Global Configuration (Recommended)

To avoid repeating configuration, use `CloudflareLoaderProvider` to set defaults for your entire application or a specific subtree.

```tsx
import { CloudflareLoaderProvider, Image, useCloudflareLoader } from "@lonik/oh-image/react";

function App() {
  return (
    // Set global defaults for Cloudflare images
    <CloudflareLoaderProvider 
      path="https://your-worker-or-zone.com" 
      format="auto" 
      placeholder={true}
    >
      <UserProfile />
    </CloudflareLoaderProvider>
  );
}

function UserProfile() {
  // Uses the globally configured loader automatically
  const loader = useCloudflareLoader(); 
  
  return (
    <Image
      src="https://example.com/profile.jpg"
      width={100}
      height={100}
      loader={loader}
      alt="Profile"
    />
  );
}
```

## Configuration Options

The `CloudflareLoaderProvider` and `useCloudflareLoader` hook accept the same options object:

| Property | Type | Default | Description |
| :--- | :--- | :--- | :--- |
| `path` | `string` | **Required** | The base URL for the image service. |
| `format` | `string` | `'auto'` | The output format. `'auto'` allows Cloudflare to serve the best format (AVIF/WebP) based on the browser. |
| `placeholder` | `boolean` | `true` | Whether to generate a low-quality placeholder. |
| `placeholderParams` | `Record<string, string>` | `{ quality: "low" }` | Transformation parameters for the placeholder image. |
| `params` | `Record<string, string>` | `undefined` | Additional processing parameters. |
| `breakpoints` | `number[]` | `undefined` | Custom breakpoints for responsive `srcSet`. |

## URL Structure

This loader generates URLs using the standard Cloudflare Image Resizing path structure:
`{path}/cdn-cgi/image/{options}/{src}`

Ensure your Cloudflare Worker or service endpoint is configured to handle this path structure.