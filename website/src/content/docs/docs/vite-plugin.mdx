---
title: Vite Plugin
description: Import and use optimized images directly with the oh-image Vite plugin
---

import { Tabs, TabItem } from "@astrojs/starlight/components";

The `oh-image` Vite plugin handles all the static image optimization for the library. It takes your image imports, processes them using [Sharp](https://sharp.pixelplumbing.com/), and creates optimized files ready for the web.

## Integration

to integrate `oh-image` plugin to your project, add `ohImage` plugin to the `vite.config.ts` plugins array

```ts
import { ohImage } from "@lonik/oh-image/plugin";

export default defineConfig({
  plugins: [ohImage()],
});
```

## Identify images

`oh-image` plugin doesn't automatically processes any image you import to your project. it is an opt-in behavior.
To command the plugin to process the image you have to add `$oh` query param to your import statement, like this

```tsx
import SomeImage from "./assets/photo.jpg?$oh";
```

## Important caveat

**Important:** The plugin can only process images located within your project's source directory (e.g., `src/assets/`, `src/images/`).

Images placed in the `public/` folder are served as-is by Vite and bypass the build process, meaning `oh-image` cannot optimize them. Move any images you wish to optimize into your `src/` folder.

## How it works

Whenever plugin gets the url of the image,
it reads the image optimizes it wraps it in `Image` component and returns it. the returned entity can
is a regular React component and can be used in React App.
For example, like this

```tsx
import SomeImage from "./assets/photo.jpg?$oh";

function App() {
  return <SomeImage />;
}
```

`SomeImage` is a regular component, then import name can be anything would you like it's just a name.

more on that you can use any props on SomeImage component besides the preconfigured ones that was preconfigures
by the plugin.

Plugin sets the following properties automatically

- width
- height
- src
- srcSet
- placeholder

because this is static image plugin can know lot's of the things about image in advance and do it for you.

## Configuration

Plugin can be configured in two different ways, local and global configuration

### Local Configuration

you can pass and overides processing options per import level, via adding additional query parameters.

```tsx
// format to avif and blur the image
import SomeImage from "./assets/photo.jpg?blur=50&format=avif&$oh";

function App() {
  return <SomeImage />;
}
```

you can find all the options below

### Global Configuration

you can also configure plugin in `vite.config.ts` to apply global level configuration

```ts
import { ohImage } from "@lonik/oh-image/plugin";

export default defineConfig({
  plugins: [
    ohImage({
      // Default output format
      format: "avif",
      placeholder: false,
      breakpoints: [640, 768, 1024, 1],
    }),
  ],
});
```

## Processing Options

| Option        | Type       | Description                                       |
| :------------ | :--------- | :------------------------------------------------ |
| `blur`        | `number`   | Blur the image with the specified sigma.          |
| `flip`        | `boolean`  | Flip the image vertically.                        |
| `flop`        | `boolean`  | Flop the image horizontally.                      |
| `rotate`      | `number`   | Rotate the image by the specified angle.          |
| `sharpen`     | `number`   | Sharpen the image with the specified sigma.       |
| `median`      | `number`   | Apply a median filter with the specified size.    |
| `gamma`       | `number`   | Apply gamma correction.                           |
| `negate`      | `boolean`  | Negate the image colors.                          |
| `normalize`   | `boolean`  | Normalize the image contrast.                     |
| `threshold`   | `number`   | Apply a threshold with the specified value.       |
| `placeholder` | `boolean`  | Generate a blurred placeholder? (`true`/`false`). |
| `breakpoints` | `number[]` | Comma-separated list of widths for `srcSet`.      |

Check more details on [Sharp](https://sharp.pixelplumbing.com/api-operation)

### Global Options

everything in Processing Options plus
| Option | Type | Description |
| :---------- | :-------- | :--------------------------------------------- |
| `distDir` | `string` | assets sub directory name where processed images will be output during build |

### Global Defaults

by default plugin has following options:

- distDir: "oh-images"
- breakpoints: [16, 48, 96, 128, 384, 640, 750, 828, 1080, 1200, 1920]
- format: "web
- placeholder: true,

## Passing Parameters as query parameters

there are different types that you can pass parameters to vite plugin:

### string

no quotes required just pass it as a constant example:

```ts
import image from "@lonik/oh-image?format=png&$oh
```

### number

pass value

```ts
import image from "@lonik/oh-image?blur=50&$oh
```

### array

pass comma separated values

```ts
import image from "@lonik/oh-image?breakpoints=16,32,64,128&$oh
```

if you want to pass an empty array for example to disable default configuration, pass only keyname

```ts
import image from "@lonik/oh-image?breakpoints8&$oh
```

### boolean

pass boolean value

```ts
import image from "@lonik/oh-image?placeholder=true&$oh
```

```ts
import image from "@lonik/oh-image?placeholder=false&$oh
```

### Unset any value

if you want to undo any value, for example nullify default option, pass the key name only

```ts
// sharp won't format the image anymore
import image from "@lonik/oh-image?format&$oh 
```

## Build vs Dev Mode

The plugin operates differently depending on your environment to balance speed and performance.

### Development (Lazy Processing)

In development, images are processed **lazily**.

Images are only processed on request and cached in vite cache directory. So you get great performance out of the box


### Production Build (Eager Processing)

During build the plugin optimized imported images suffix with `$oh` and automatically generates 
placeholder ans srcSet images based on configuration. Also image URLs are properly configured 
so the app will properly fetch images from static folder